<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nexus Tiranga: Badge Edition</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #050505; --card-bg: #111111;
            --saffron: #FF9933; --white: #FFFFFF; --green: #138808;
            --army: #4B5320; --navy: #000080; --airforce: #5D8AA8;
        }

        body {
            font-family: 'Segoe UI', sans-serif; background-color: var(--bg-color);
            margin: 0; display: flex; justify-content: center; align-items: center;
            height: 100vh; overflow: hidden; color: white;
        }

        /* --- Force Selection --- */
        #force-selection {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color); z-index: 999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        .force-card {
            width: 85%; max-width: 300px; padding: 20px; margin: 10px 0;
            border-radius: 15px; cursor: pointer; text-align: center;
            font-weight: 900; transition: 0.3s; border: 2px solid transparent;
        }
        .army-card { background: var(--army); border-color: #6B8E23; }
        .navy-card { background: var(--navy); border-color: #4169E1; }
        .airforce-card { background: var(--airforce); border-color: #B0C4DE; }

        /* --- Dashboard --- */
        .neon-card {
            position: relative; width: 310px; padding: 30px 20px;
            background: var(--card-bg); border-radius: 24px; text-align: center;
            border: 1px solid rgba(255,255,255,0.1);
        }

        /* The Badge Display */
        #badge-display {
            width: 60px; height: 60px; margin: -50px auto 10px;
            background: var(--card-bg); border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 2rem; border: 3px solid var(--saffron);
            box-shadow: 0 0 15px var(--saffron);
            z-index: 100; position: relative;
        }

        .btn { width: 100%; padding: 15px; border-radius: 12px; font-weight: 900; cursor: pointer; border: none; margin-top: 15px; }
        .confirm-btn { background: linear-gradient(90deg, var(--saffron), var(--white), var(--green)); color: black; }
        
        select { width: 85%; padding: 12px; margin-top: 10px; background: #222; color: white; border-radius: 10px; border: 1px solid #444; }
    </style>
</head>
<body>

    <div id="force-selection">
        <h2 style="letter-spacing: 2px;">CHOOSE YOUR COMMAND</h2>
        
        <div class="force-card army-card" onclick="showUnits('Army')">‚öîÔ∏è INDIAN ARMY</div>
        <div class="force-card navy-card" onclick="showUnits('Navy')">‚öì INDIAN NAVY</div>
        <div class="force-card airforce-card" onclick="showUnits('AirForce')">‚úàÔ∏è INDIAN AIR FORCE</div>

        <div id="unit-box" style="display:none; width:100%; text-align:center;">
            <select id="unit-select"></select>
            <button class="btn confirm-btn" style="width: 85%;" onclick="applyBadge()">PROCEED TO BASE</button>
        </div>
    </div>

    <div class="neon-card" id="dashboard" style="display:none; margin-top: 40px;">
        <div id="badge-display">üáÆüá≥</div>
        <h3 id="unit-title" style="margin: 0; color: var(--saffron); font-size: 0.8rem;">UNIT NAME</h3>
        <img id="user-photo" src="" style="width: 90px; height: 90px; border-radius: 50%; border: 3px solid white; margin: 15px 0;">
        <h2 id="user-name" style="margin: 0;">OFFICER</h2>
        <p id="service-text" style="font-size: 0.7rem; color: #888;"></p>
        <button class="btn confirm-btn" onclick="finish()">SALUTE & EXIT</button>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        const data = {
            Army: { units: ['Para SF', 'Gorkha Rifles', 'Sikh Regt'], badge: '‚öîÔ∏è' },
            Navy: { units: ['MARCOS', 'Naval Pilots', 'Submariners'], badge: '‚öì' },
            AirForce: { units: ['Garud', 'Fighter Wing', 'Skylords'], badge: 'ü¶Ö' }
        };

        let currentForce = "";

        function showUnits(force) {
            currentForce = force;
            const select = document.getElementById('unit-select');
            select.innerHTML = "";
            data[force].units.forEach(u => {
                let opt = document.createElement('option');
                opt.value = u; opt.innerText = u;
                select.appendChild(opt);
            });
            document.getElementById('unit-box').style.display = 'block';
            tg.HapticFeedback.impactOccurred('medium');
        }

        function applyBadge() {
            const unit = document.getElementById('unit-select').value;
            document.getElementById('force-selection').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            
            // Set Badge and Colors
            const display = document.getElementById('badge-display');
            display.innerText = data[currentForce].badge;
            
            document.getElementById('unit-title').innerText = unit.toUpperCase();
            document.getElementById('service-text').innerText = "OFFICIALLY APPOINTED TO THE " + currentForce.toUpperCase();
            
            tg.HapticFeedback.notificationOccurred('success');
        }

        // Load User Info
        const user = tg.initDataUnsafe?.user;
        if (user) {
            document.getElementById('user-name').innerText = user.first_name.toUpperCase();
            document.getElementById('user-photo').src = user.photo_url || `https://ui-avatars.com/api/?name=${user.first_name}&background=FF9933&color=fff`;
        }

        function finish() {
            tg.sendData(`Appointed: ${document.getElementById('unit-title').innerText}`);
            tg.close();
        }
    </script>
</body>
</html>
