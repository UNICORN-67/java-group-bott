<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nexus Tiranga: Global Roster</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-color: #050505; --card-bg: #111111;
            --saffron: #FF9933; --white: #FFFFFF; --green: #138808;
            --blue: #000080; --army: #4B5320; --navy: #000080; --airforce: #5D8AA8;
        }

        body { font-family: 'Segoe UI', sans-serif; background: var(--bg-color); margin: 0; color: white; overflow: hidden; height: 100vh; }

        /* --- SCREENS --- */
        .screen { position: fixed; inset: 0; display: none; flex-direction: column; align-items: center; padding: 20px; overflow-y: auto; background: #000; z-index: 10; }
        .active-screen { display: flex; }

        /* --- FORCE STRENGTH COUNTER --- */
        .force-stats {
            background: rgba(255,255,255,0.05); width: 100%; max-width: 340px;
            padding: 15px; border-radius: 12px; margin-bottom: 20px;
            text-align: center; border: 1px dashed var(--saffron);
        }

        /* --- LEADERBOARD & ROSTER --- */
        .roster-list { width: 100%; max-width: 340px; display: flex; flex-direction: column; gap: 10px; }
        .officer-card {
            display: flex; align-items: center; background: var(--card-bg);
            padding: 12px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1);
        }
        .officer-img { width: 45px; height: 45px; border-radius: 50%; border: 2px solid var(--white); margin-right: 12px; }
        .officer-info { flex: 1; }
        .officer-name { font-size: 0.9rem; font-weight: bold; }
        .officer-unit { font-size: 0.65rem; color: var(--saffron); text-transform: uppercase; }
        .officer-rank { font-size: 0.6rem; color: #888; }

        /* --- BUTTONS --- */
        .btn { width: 100%; max-width: 340px; padding: 16px; border-radius: 12px; font-weight: 900; border: none; cursor: pointer; margin-top: 10px; text-transform: uppercase; }
        .gold-btn { background: linear-gradient(90deg, var(--saffron), var(--white), var(--green)); color: black; }
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: #111; display: flex; justify-content: space-around; padding: 10px 0; border-top: 1px solid #333; z-index: 100; }
        .nav-item { font-size: 0.7rem; color: #888; text-align: center; cursor: pointer; }
        .nav-active { color: var(--saffron); font-weight: bold; }

        /* --- DASHBOARD NEON --- */
        .neon-card { position: relative; width: 280px; padding: 30px; background: var(--card-bg); border-radius: 24px; text-align: center; margin-top: 40px; }
        .neon-card::before { content: ''; position: absolute; inset: -2px; background: linear-gradient(45deg, var(--saffron), var(--white), var(--green)); background-size: 400%; z-index: -1; border-radius: 26px; animation: flag-flow 8s linear infinite; filter: blur(8px); }
        
        @keyframes flag-flow { 0% { background-position: 0% 50%; } 100% { background-position: 400% 50%; } }
    </style>
</head>
<body>

    <div id="screen-select" class="screen">
        <h2 style="margin-top:40px;">ENLIST NOW</h2>
        <div class="roster-list" style="margin-top:20px;">
            <button class="btn gold-btn" onclick="setForce('ARMY', 'PARA SF')">JOIN ARMY (PARA SF)</button>
            <button class="btn gold-btn" onclick="setForce('NAVY', 'MARCOS')">JOIN NAVY (MARCOS)</button>
            <button class="btn gold-btn" onclick="setForce('AIR FORCE', 'GARUD')">JOIN AIR FORCE (GARUD)</button>
        </div>
    </div>

    <div id="screen-dash" class="screen">
        <div class="neon-card">
            <div id="rank-tag" style="color:gold; font-size:0.7rem; border:1px solid gold; padding:2px 8px; display:inline-block; border-radius:10px;">LIEUTENANT</div>
            <br><img id="u-img" src="" class="officer-img" style="width:80px; height:80px; margin:15px 0;">
            <h2 id="u-name" style="margin:0;">OFFICER</h2>
            <p id="u-unit" style="color:var(--saffron); font-size:0.8rem;"></p>
            <button class="btn gold-btn" onclick="addService()">REPORT FOR DUTY</button>
        </div>
    </div>

    <div id="screen-roster" class="screen">
        <h2 style="margin-top:20px;">FORCE BATTALION</h2>
        <div class="force-stats">
            <span style="font-size: 0.8rem; color: #aaa;">TOTAL STRENGTH</span><br>
            <span style="font-size: 1.5rem; font-weight: 900;" id="total-joined">14,209 SOLDIERS</span>
        </div>

        <div class="roster-list" id="roster-items">
            <div class="officer-card" style="border: 1px solid var(--saffron);">
                <img id="my-img-small" src="" class="officer-img">
                <div class="officer-info">
                    <div class="officer-name" id="my-name-lb">YOU</div>
                    <div class="officer-unit" id="my-unit-lb">UNIT PENDING</div>
                </div>
                <div class="officer-rank" id="my-score-lb">0 MISSIONS</div>
            </div>
            
            <hr style="width:100%; border:0; border-top:1px solid #333; margin:10px 0;">
            
            <div class="officer-card">
                <img src="https://i.pravatar.cc/100?u=1" class="officer-img">
                <div class="officer-info">
                    <div class="officer-name">Vikram Singh</div>
                    <div class="officer-unit">ARMY ‚Ä¢ PARA SF</div>
                </div>
                <div class="officer-rank">422 MISSIONS</div>
            </div>
            <div class="officer-card">
                <img src="https://i.pravatar.cc/100?u=2" class="officer-img">
                <div class="officer-info">
                    <div class="officer-name">Ananya Iyer</div>
                    <div class="officer-unit">NAVY ‚Ä¢ MARCOS</div>
                </div>
                <div class="officer-rank">389 MISSIONS</div>
            </div>
        </div>
    </div>

    <div class="nav-bar">
        <div class="nav-item" onclick="showScreen('screen-dash')">üè†<br>BASE</div>
        <div class="nav-item" onclick="showScreen('screen-roster')">üéñÔ∏è<br>ROSTER</div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready(); tg.expand();

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active-screen'));
            document.getElementById(id).classList.add('active-screen');
            tg.HapticFeedback.impactOccurred('light');
        }

        window.onload = () => {
            const b = localStorage.getItem('p_branch');
            const u = localStorage.getItem('p_unit');
            if (b && u) {
                updateUI(b, u);
                showScreen('screen-dash');
            } else {
                showScreen('screen-select');
            }
            loadUser();
        };

        function setForce(b, u) {
            localStorage.setItem('p_branch', b);
            localStorage.setItem('p_unit', u);
            updateUI(b, u);
            showScreen('screen-dash');
            tg.HapticFeedback.notificationOccurred('success');
        }

        function updateUI(b, u) {
            document.getElementById('u-unit').innerText = b + " ‚Ä¢ " + u;
            document.getElementById('my-unit-lb').innerText = b + " ‚Ä¢ " + u;
            
            const s = localStorage.getItem('s_rec') || "0";
            document.getElementById('my-score-lb').innerText = s + " MISSIONS";
            
            let rank = "LIEUTENANT";
            if(s >= 10) rank = "GENERAL";
            else if(s >= 5) rank = "MAJOR";
            document.getElementById('rank-tag').innerText = rank;
        }

        function addService() {
            let s = parseInt(localStorage.getItem('s_rec') || "0") + 1;
            localStorage.setItem('s_rec', s);
            updateUI(localStorage.getItem('p_branch'), localStorage.getItem('p_unit'));
            tg.HapticFeedback.notificationOccurred('success');
            tg.showAlert("Mission Logged! Jai Hind.");
        }

        function loadUser() {
            const user = tg.initDataUnsafe?.user;
            const name = user ? user.first_name.toUpperCase() : "OFFICER";
            const img = user?.photo_url || `https://ui-avatars.com/api/?name=${name}&background=FF9933&color=fff`;
            
            document.getElementById('u-name').innerText = name;
            document.getElementById('my-name-lb').innerText = name + " (YOU)";
            document.getElementById('u-img').src = img;
            document.getElementById('my-img-small').src = img;
        }
    </script>
</body>
</html>
